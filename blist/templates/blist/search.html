{% extends "base.html" %}

{% block title %} | Search {{ query }}{% endblock %}

{% block head %}
<script>
    //Initialize the source option of .autocomplete widget during page load
    //See: http://api.jqueryui.com/autocomplete/#method-option setter example code
    var local_source = ["Abc",]  //Dummy string for initialization only; temporary value
    $("#search_box").autocomplete("option", "source", local_source)
</script>
<script>
    //.autocomplete widget is Dajaxice callback function
    // *data* comes from server-side function
    function search_result(data) {
        $("#search_box").autocomplete({
            source: data,
        });
    }
</script>
<script>
    //This function called by user <input> tag and calls the server-side function via Dajaxice command
    function dajax_filter_search_term() {
        Dajaxice.blist.auto_filter_search_term(search_result,{'search_term':$('#search_box').val()});
        //                  |                     |                  |      ----------------------
        //                  |                     |                  |                |
        //             server-side          .autcomplete      serverside          user-typed
        //              function           callback func.    func. argument      value to search
    }
</script>
{% endblock %}
{% block content %}

<h1>Search</h1>

<div class='ui-widget'>
<form action="" method="get">
    <input type="text" name="q" id="search_box" onkeyup="dajax_filter_search_term()" />
    <input type="submit" value="Search">
</form>
</div>

{% if error %}<p style="color: red">Please enter a value.</p>{% endif %}


	<p>Search results for {{ query }}.</p>


{% if items %}
	<p>Found {{ items|length }} item{{ items|pluralize }}.</p>
		<ul>
			{% for item in items %}
			<li>{% if item.finish == NULL %}
    				<a href="{% url 'blist:details' item.pk %}">{{ item.item_value }}</a> 
    			{% else %}
    				<a href="{% url 'blist:details' item.pk %}" style='color:green'>{{ item.item_value }}</a> 
   		    	{% endif %} - in list <a href="{% url 'blist:items' item.bucket.id %}">{{ item.bucket }}</a></li>
			{% endfor %}
		</ul>
{% else %}
	<p>No items matched your search criteria.</p>
{% endif %}

{% endblock %}
